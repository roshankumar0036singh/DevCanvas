flowchart TD
%% ========== SUBGRAPHS ==========
    subgraph Core["Core Application"]
        A1["Main App(App.tsx)"]
        R1["Router"]
        C1["Global Context(Store)"]
        T1["Theme System"]
    end

    subgraph UI_Components["UI Components"]
        UC1["Sidebar"]
        UC2["Button & UI Primitives"]
        UC3["Popup Layout(popup/App.tsx)"]
    end

    subgraph Feature_Modules["Feature Modules"]
        FM1["Dashboard Page"]
        FM2["Settings Page"]
        FM3["Diagram Editor"]
        FM4["Document Editor"]
        FM5["RAG Integration Panel"]
        FM6["Node Editors(Custom Nodes)"]
    end

    subgraph Services["Services"]
        S1["Auth Service"]
        S2["AI Processing Service"]
        S3["GitHub Integration"]
        S4["File System Abstraction"]
    end

    subgraph Utilities["Utilities"]
        U1["Markdown Processing"]
        U2["Layout Algorithms"]
        U3["Storage Helpers"]
        U4["Messaging System"]
        U5["RAG Pipeline"]
        U6["Exporters(Mermaid/PlantUML)"]
    end

    subgraph Background_Scripts["Background Scripts"]
        BS1["Service Worker"]
        BS2["Content Script"]
    end

    subgraph CLI["CLI Tools"]
        CL1["Build/Dev Scripts"]
    end

    %% ========== EXTERNAL DEPENDENCIES(if inferred from utils/services) ==========
    %% NOTE: Only included if explicitly referenced in code(e.g., Firebase SDK imports)
    %% Placeholder for future explicit deps(currently none validated)
    %% External1["<External Service>"]

    %% ========== FLOW CONNECTIONS ==========
    %% Core Dependencies
    A1 --> R1
    A1 --> C1
    A1 --> T1

    %% UI Composition
    UC3 --> UC1
    UC3 --> UC2
    UC3 --> FM3["Diagram Editor"]
    UC3 --> FM4["Document Editor"]
    UC3 --> FM5["RAG Panel"]

    %% Feature Module Dependencies
    FM1 --> FM3
    FM1 --> FM6
    FM3 --> U6
    FM5 --> U5
    FM5 --> S2

    %% Service Dependencies
    S2 --> U4["Messaging"]
    S3 --> U4
    S1 --> U4
    S3 --> U3["Storage"]

    %% Utility Dependencies
    U5 --> U3
    U5 --> U1["Markdown"]
    U6 --> U2["Layout"]

    %% Script Interactions
    BS1 -.-> U4
    BS2 -.-> U4
    BS2 -.-> FM3

    %% CLI Build Flow
    CL1 -.-> A1
    CL1 -.-> BS1

    %% ========== STYLING ==========
    classDef core fill:#f9f,stroke:#333,color:#000
    classDef feature fill:#bbf,stroke:#333,color:#000
    classDef service fill:#f96,stroke:#333,color:#000
    classDef utility fill:#9f9,stroke:#333,color:#000
    classDef script fill:#99f,stroke:#333,color:#000
    classDef cli fill:#f6f,stroke:#333,color:#000

    class A1,R1,C1,T1 core
    class FM1,FM2,FM3,FM4,FM5,FM6 feature
    class S1,S2,S3,S4 service
    class U1,U2,U3,U4,U5,U6 utility
    class BS1,BS2 script
    class CL1 cli